# v0.3.5 - 技能系统管理技术设计

## 1. API 接口设计

### 1.1 获取技能列表

```
GET /api/skills?category={category}&enabled_only={bool}
```

**响应示例**：
```json
{
  "skills": [
    {
      "skill_id": "skill-pdf",
      "name": "PDF 处理",
      "description": "读取、创建和编辑 PDF 文件",
      "category": "文件处理",
      "version": "1.2.0",
      "is_enabled": true,
      "is_builtin": true
    }
  ]
}
```

### 1.2 获取技能详情

```
GET /api/skills/{skill_id}
```

### 1.3 启用技能

```
POST /api/skills/{skill_id}/enable
```

### 1.4 禁用技能

```
POST /api/skills/{skill_id}/disable
```

### 1.5 获取用户配置

```
GET /api/skills/config
```

### 1.6 更新用户配置

```
PUT /api/skills/config
```

## 2. 数据结构设计

### 2.1 Skill

```python
from pydantic import BaseModel

class SkillParameter(BaseModel):
    name: str
    type: str
    default: Any
    description: str

class Skill(BaseModel):
    skill_id: str
    name: str
    description: str
    category: str
    version: str
    author: str
    tags: list[str]
    is_enabled: bool
    is_builtin: bool
    parameters: list[SkillParameter]
    examples: list[dict]
    permissions: list[str]
```

## 3. 后端实现

### 3.1 路由设计

新建 `app/routers/skills.py`：

```python
from fastapi import APIRouter, Query

router = APIRouter(prefix="/api/skills", tags=["skills"])

@router.get("")
async def get_skills(
    category: str = None,
    enabled_only: bool = False
):
    """获取技能列表"""
    ...

@router.get("/{skill_id}")
async def get_skill(skill_id: str):
    """获取技能详情"""
    ...

@router.post("/{skill_id}/enable")
async def enable_skill(skill_id: str):
    """启用技能"""
    ...

@router.post("/{skill_id}/disable")
async def disable_skill(skill_id: str):
    """禁用技能"""
    ...
```

### 3.2 技能管理

```python
from pathlib import Path

class SkillManager:
    """技能管理器"""

    SKILLS_DIR = Path.home() / ".claude" / "skills"

    def get_skills(self) -> list[Skill]:
        """获取技能列表"""
        ...

    def enable_skill(self, skill_id: str):
        """启用技能"""
        ...

    def disable_skill(self, skill_id: str):
        """禁用技能"""
        ...
```

## 4. 前端设计

### 4.1 页面结构

```
┌─────────────────────────────────────────────────────────────┐
│  技能系统管理                                                │
│                                                             │
│  [全部] [文件处理] [代码开发] [AI工具] [其他]                │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ PDF 处理        │ 文件处理  │ v1.2.0 │ [启用] ✓   │   │
│  │ Git 操作        │ 版本控制  │ v1.0.0 │ [启用] ✓   │   │
│  │ 数据库工具      │ 数据处理  │ v0.9.0 │ [禁用]     │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

## 5. 关键文件

| 文件 | 操作 |
|------|------|
| `app/routers/skills.py` | 新建 |
| `app/skills/manager.py` | 新建 |
| `app/main.py` | 修改 - 注册路由 |
| `web/static/modules/skillManager.js` | 新建 |
