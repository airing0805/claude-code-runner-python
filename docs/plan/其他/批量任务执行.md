# 批量任务执行

## 概述

支持一次性提交多个任务，批量处理。

## 需求

### 6.1 API 设计

```json
# 提交批量任务
POST /api/tasks/batch
{
  "tasks": [
    {
      "prompt": "任务1",
      "working_dir": "/path1"
    },
    {
      "prompt": "任务2",
      "working_dir": "/path2"
    }
  ],
  "mode": "parallel"  // parallel 或 sequential
}

Response: 202 Accepted
{
  "batch_id": "uuid",
  "total": 2,
  "status": "pending"
}

# 查询批量任务
GET /api/tasks/batch/{batch_id}

Response: 200 OK
{
  "batch_id": "uuid",
  "total": 2,
  "completed": 1,
  "failed": 0,
  "results": [
    {
      "index": 0,
      "status": "completed",
      "result": {...}
    },
    {
      "index": 1,
      "status": "running"
    }
  ]
}
```

### 6.2 执行模式

| 模式 | 说明 | 适用场景 |
|------|------|----------|
| parallel | 并行执行 | 独立任务 |
| sequential | 顺序执行 | 有依赖关系的任务 |

### 6.3 限制

- 单次批量任务最大数量: 50
- 批量任务总超时: 60 分钟

## 实现

- 使用 asyncio.gather 并行执行
- 返回每个子任务的结果
- 支持部分失败（容忍模式）
