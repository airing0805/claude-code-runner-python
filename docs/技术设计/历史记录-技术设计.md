# 会话管理 API 技术设计

## 概述

会话管理 API 提供项目列表和会话列表查询功能，用于管理 Claude Code 执行的历史会话。

---

## 项目列表

### GET /api/projects

获取所有项目列表（含工具汇总）。

**响应**:

```json
{
  "projects": [
    {
      "encoded_name": "E--workspaces-2026-python",
      "path": "E:\\workspaces_2026_python\\project",
      "session_count": 5,
      "tools": ["Read", "Write", "Edit", "Bash"]
    }
  ]
}
```

---

## 会话列表

### GET /api/projects/{project_name}/sessions

获取指定项目的会话列表。

**参数**:
- `project_name`: 项目编码名称（URL 编码）

**响应**:

```json
{
  "project_name": "E--workspaces-2026-python-claude-code-runner",
  "project_path": "E:\\workspaces_2026_python\\claude-code-runner",
  "sessions": [
    {
      "id": "abc123def456",
      "title": "列出当前目录下所有 Python 文件",
      "timestamp": "2026-02-18T10:00:00",
      "message_count": 10,
      "size": 5000
    }
  ]
}
```

---

## 数据结构

### 会话元数据

| 字段 | 类型 | 说明 |
|------|------|------|
| id | string | 会话唯一 ID |
| title | string | 会话标题（首条用户消息，过滤 ide_selection 和 ide_opened_file 标签） |
| timestamp | string | 创建时间 |
| message_count | int | 消息数量 |
| size | int | 会话数据大小（字节） |
