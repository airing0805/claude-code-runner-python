# Claude Code Runner å¼€å‘æ–‡æ¡£

## æŠ€æœ¯è®¾è®¡æ–‡æ¡£ç´¢å¼•

### 1. æ¦‚è¿°

æœ¬æ–‡æ¡£ç´¢å¼•åˆ—å‡ºäº†æ‰€æœ‰æŠ€æœ¯è®¾è®¡æ–‡æ¡£ï¼ŒæŒ‰ç…§åŠŸèƒ½æ¨¡å—è¿›è¡Œåˆ†ç±»ï¼Œæ–¹ä¾¿å¼€å‘äººå‘˜å¿«é€ŸæŸ¥æ‰¾ç›¸å…³æŠ€æœ¯è®¾è®¡èµ„æ–™ã€‚

### 2. æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

#### 2.1 å½“å‰ä¼šè¯ç®¡ç†
- [å½“å‰ä¼šè¯-æŠ€æœ¯è®¾è®¡.md](å½“å‰ä¼šè¯-æŠ€æœ¯è®¾è®¡.md) - å½“å‰ä¼šè¯æ ¸å¿ƒåŠŸèƒ½è®¾è®¡
- [å½“å‰ä¼šè¯-è¾“å‡ºå®ç°-æŠ€æœ¯è®¾è®¡.md](å½“å‰ä¼šè¯-è¾“å‡ºå®ç°-æŠ€æœ¯è®¾è®¡.md) - ä¼šè¯è¾“å‡ºè¯¦ç»†å®ç°
- [AskUserQuestionå¤šè½®å¯¹è¯-æŠ€æœ¯è®¾è®¡.md](AskUserQuestionå¤šè½®å¯¹è¯-æŠ€æœ¯è®¾è®¡.md) - å¤šè½®å¯¹è¯äº¤äº’è®¾è®¡

#### 2.2 ClaudeçŠ¶æ€ç›‘æ§
- [Claude çŠ¶æ€-æŠ€æœ¯è®¾è®¡.md](Claude çŠ¶æ€-æŠ€æœ¯è®¾è®¡.md) - ClaudeæœåŠ¡çŠ¶æ€ç›‘æ§è®¾è®¡
- [Claude æ–‡æ¡£-æŠ€æœ¯è®¾è®¡.md](Claude æ–‡æ¡£-æŠ€æœ¯è®¾è®¡.md) - Claudeæ–‡æ¡£ç³»ç»Ÿè®¾è®¡

#### 2.3 ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ
- [ä»»åŠ¡è°ƒåº¦-æ ¸å¿ƒè®¾è®¡.md](ä»»åŠ¡è°ƒåº¦-æ ¸å¿ƒè®¾è®¡.md) - ä»»åŠ¡è°ƒåº¦æ ¸å¿ƒæ¶æ„è®¾è®¡
- [ä»»åŠ¡è°ƒåº¦-æ•°æ®æ¨¡å‹.md](ä»»åŠ¡è°ƒåº¦-æ•°æ®æ¨¡å‹.md) - ä»»åŠ¡æ•°æ®ç»“æ„å®šä¹‰
- [ä»»åŠ¡è°ƒåº¦-å­˜å‚¨å±‚.md](ä»»åŠ¡è°ƒåº¦-å­˜å‚¨å±‚.md) - JSON æ–‡ä»¶å­˜å‚¨å±‚è®¾è®¡
- [ä»»åŠ¡è°ƒåº¦-Cronè§£æ.md](ä»»åŠ¡è°ƒåº¦-Cronè§£æ.md) - Cron è¡¨è¾¾å¼è§£æè®¾è®¡

#### 2.4 æ’ä»¶ä¸æ‰©å±•
- [æ’ä»¶ç®¡ç†-æŠ€æœ¯è®¾è®¡.md](æ’ä»¶ç®¡ç†-æŠ€æœ¯è®¾è®¡.md) - æ’ä»¶ç®¡ç†ç³»ç»Ÿè®¾è®¡
- [æŠ€èƒ½ç®¡ç†-æŠ€æœ¯è®¾è®¡.md](æŠ€èƒ½ç®¡ç†-æŠ€æœ¯è®¾è®¡.md) - æŠ€èƒ½ç®¡ç†åŠŸèƒ½è®¾è®¡
- [MCPæœåŠ¡å™¨ç®¡ç†-æŠ€æœ¯è®¾è®¡.md](MCPæœåŠ¡å™¨ç®¡ç†-æŠ€æœ¯è®¾è®¡.md) - MCPæœåŠ¡å™¨ç®¡ç†è®¾è®¡

#### 2.5 ç³»ç»Ÿç®¡ç†
- [é’©å­é…ç½®-æŠ€æœ¯è®¾è®¡.md](é’©å­é…ç½®-æŠ€æœ¯è®¾è®¡.md) - é’©å­é…ç½®ç³»ç»Ÿè®¾è®¡
- [Agentç›‘æ§-æŠ€æœ¯è®¾è®¡.md](Agentç›‘æ§-æŠ€æœ¯è®¾è®¡.md) - Agentç›‘æ§ç³»ç»Ÿè®¾è®¡
- [å†å²è®°å½•-æŠ€æœ¯è®¾è®¡.md](å†å²è®°å½•-æŠ€æœ¯è®¾è®¡.md) - å†å²è®°å½•ç®¡ç†è®¾è®¡

### 3. æŠ€æœ¯è®¾è®¡è§„èŒƒ

#### 3.1 è®¾è®¡åŸåˆ™
- æ¨¡å—åŒ–è®¾è®¡ï¼Œé«˜å†…èšä½è€¦åˆ
- å‰åç«¯åˆ†ç¦»ï¼Œæ¥å£æ ‡å‡†åŒ–
- å¯æ‰©å±•æ€§ä¼˜å…ˆï¼Œé¢„ç•™æ‰©å±•ç‚¹
- æ€§èƒ½ä¸å®‰å…¨å¹¶é‡

#### 3.2 æ–‡æ¡£ç¼–å†™è§„èŒƒ
- ä½¿ç”¨ç»Ÿä¸€çš„æ–‡æ¡£æ¨¡æ¿
- å›¾è¡¨å’Œä»£ç ç¤ºä¾‹ç›¸ç»“åˆ
- ä¿æŒæ–‡æ¡£ä¸ä»£ç åŒæ­¥æ›´æ–°
- æä¾›æ¸…æ™°çš„ç‰ˆæœ¬æ§åˆ¶

### 4. å‘å¸ƒæ¸…å•

- [ ] æ›´æ–°ç‰ˆæœ¬å·
- [ ] è¿è¡Œæµ‹è¯•ç¡®ä¿é€šè¿‡
- [ ] æ›´æ–°æ–‡æ¡£
- [ ] æ£€æŸ¥ä¾èµ–ç‰ˆæœ¬
- [ ] åˆ›å»º Git æ ‡ç­¾

---

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

1. å®‰è£… Python 3.10+
2. å®‰è£… uv åŒ…ç®¡ç†å™¨
3. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶
ANTHROPIC_API_KEY=your-api-key
WORKING_DIR=/path/to/your/project
HOST=127.0.0.1
PORT=8000
```

### å®‰è£…ä¾èµ–

```bash
uv sync
```

### å¯åŠ¨æœåŠ¡

```bash
# æ–¹å¼ 1: ç›´æ¥è¿è¡Œ
uv run python -m app.main

# æ–¹å¼ 2: ä½¿ç”¨ uvicornï¼ˆæ”¯æŒçƒ­é‡è½½ï¼‰
uv run uvicorn app.main:app --reload
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
uv run pytest tests/ -v

# è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºè¦†ç›–ç‡
uv run pytest tests/ -v --cov=app
```

---

## é¡¹ç›®ç»“æ„

```
claude-code-runner/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py              # FastAPI ä¸»åº”ç”¨
â”‚   â”œâ”€â”€ claude_runner/       # Claude Code å°è£…
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ client.py
â”‚   â”œâ”€â”€ scheduler/           # ä»»åŠ¡è°ƒåº¦æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py      # æ¨¡å—å¯¼å‡º
â”‚   â”‚   â”œâ”€â”€ models.py        # æ•°æ®æ¨¡å‹ï¼ˆTaskã€ScheduledTaskã€TaskStatusï¼‰
â”‚   â”‚   â”œâ”€â”€ storage.py       # JSON æ–‡ä»¶å­˜å‚¨å±‚
â”‚   â”‚   â”œâ”€â”€ cron.py          # Cron è¡¨è¾¾å¼è§£æå™¨
â”‚   â”‚   â””â”€â”€ config.py        # é…ç½®å¸¸é‡
â”‚   â”œâ”€â”€ routers/             # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ task.py
â”‚   â”‚   â”œâ”€â”€ session.py
â”‚   â”‚   â””â”€â”€ status.py
â”‚   â”œâ”€â”€ templates/           # Web ç•Œé¢æ¨¡æ¿ï¼ˆå·²è¿ç§»åˆ° web ç›®å½•ï¼‰
â”‚   â””â”€â”€ static/              # é™æ€æ–‡ä»¶ï¼ˆå·²è¿ç§»åˆ° web ç›®å½•ï¼‰
â”œâ”€â”€ web/
â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â””â”€â”€ index.html       # Web ç•Œé¢æ¨¡æ¿
â”‚   â””â”€â”€ static/
â”‚       â”œâ”€â”€ style.css        # æ ·å¼æ–‡ä»¶
â”‚       â””â”€â”€ app.js           # å‰ç«¯äº¤äº’é€»è¾‘
â”œâ”€â”€ data/                    # ä»»åŠ¡è°ƒåº¦æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ queue.json           # ä»»åŠ¡é˜Ÿåˆ—
â”‚   â”œâ”€â”€ scheduled.json       # å®šæ—¶ä»»åŠ¡
â”‚   â”œâ”€â”€ running.json         # è¿è¡Œä¸­ä»»åŠ¡
â”‚   â”œâ”€â”€ completed.json       # å·²å®Œæˆä»»åŠ¡
â”‚   â””â”€â”€ failed.json          # å¤±è´¥ä»»åŠ¡
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_runner.py       # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ test_scheduler_models.py  # è°ƒåº¦å™¨æ¨¡å‹æµ‹è¯•
â”‚   â””â”€â”€ test_scheduler_storage.py # è°ƒåº¦å™¨å­˜å‚¨æµ‹è¯•
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ éœ€æ±‚æ–‡æ¡£.md      # éœ€æ±‚æ–‡æ¡£
â”‚   â”œâ”€â”€ APIæ¥å£.md               # API æ–‡æ¡£
â”‚   â””â”€â”€ å¼€å‘æŒ‡å—.md       # å¼€å‘æ–‡æ¡£
â”œâ”€â”€ .env.example             # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ pyproject.toml           # é¡¹ç›®é…ç½®
â””â”€â”€ CLAUDE.md                # Claude Code é¡¹ç›®æŒ‡å¯¼
```

---

## æ ¸å¿ƒç»„ä»¶

### ClaudeCodeClient (`app/claude_runner/client.py`)

å°è£… Claude Codeï¼Œæä¾›ä¸¤ç§æ‰§è¡Œæ¨¡å¼ï¼š

```python
from app.claude_runner import ClaudeCodeClient

# åˆ›å»ºå®¢æˆ·ç«¯
client = ClaudeCodeClient(
    working_dir="/path/to/project",
    allowed_tools=["Read", "Write", "Edit", "Bash"],
    permission_mode="acceptEdits",
    continue_conversation=False,
    resume=None
)

# åŒæ­¥æ‰§è¡Œ
result = await client.run("åˆ—å‡ºæ‰€æœ‰ Python æ–‡ä»¶")
print(result.message)

# æµå¼æ‰§è¡Œ
async for msg in client.run_stream("åˆ†æé¡¹ç›®ç»“æ„"):
    print(f"[{msg.type.value}] {msg.content}")
```

#### å…³é”®æ–¹æ³•

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `run(prompt)` | åŒæ­¥æ‰§è¡Œï¼Œè¿”å› TaskResult |
| `run_stream(prompt)` | æµå¼æ‰§è¡Œï¼Œå¼‚æ­¥è¿­ä»£å™¨ |

#### æ•°æ®ç»“æ„

```python
# æµå¼æ¶ˆæ¯
@dataclass
class StreamMessage:
    type: MessageType      # æ¶ˆæ¯ç±»å‹
    content: str           # å†…å®¹
    timestamp: str         # æ—¶é—´æˆ³
    tool_name: str         # å·¥å…·åç§°ï¼ˆå¯é€‰ï¼‰
    tool_input: dict       # å·¥å…·è¾“å…¥ï¼ˆå¯é€‰ï¼‰
    metadata: dict         # å…ƒæ•°æ®

# ä»»åŠ¡ç»“æœ
@dataclass
class TaskResult:
    success: bool
    message: str
    session_id: str
    cost_usd: float
    duration_ms: int
    files_changed: list[str]
    tools_used: list[str]
```

### FastAPI åº”ç”¨ (`app/main.py`)

æä¾› REST API å’Œ Web ç•Œé¢ï¼š

```python
# å…³é”®è·¯ç”±
@app.post("/api/task")              # åŒæ­¥ä»»åŠ¡
@app.post("/api/task/stream")       # æµå¼ä»»åŠ¡
@app.get("/api/projects")           # é¡¹ç›®åˆ—è¡¨
@app.get("/api/projects/{name}/sessions")  # ä¼šè¯åˆ—è¡¨
@app.get("/api/sessions/{id}/messages")    # ä¼šè¯æ¶ˆæ¯
```

---

## ä»»åŠ¡è°ƒåº¦æ¨¡å— (`app/scheduler/`)

ä»»åŠ¡è°ƒåº¦æ¨¡å—æä¾›ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†å’Œå®šæ—¶ä»»åŠ¡åŠŸèƒ½ï¼Œæ”¯æŒ Cron è¡¨è¾¾å¼ã€‚

### æ ¸å¿ƒç»„ä»¶

#### æ•°æ®æ¨¡å‹ (`models.py`)

```python
from app.scheduler.models import Task, ScheduledTask, TaskStatus

# ä»»åŠ¡çŠ¶æ€æšä¸¾
class TaskStatus(str, Enum):
    PENDING = "pending"      # å¾…æ‰§è¡Œ
    RUNNING = "running"      # è¿è¡Œä¸­
    COMPLETED = "completed"  # å·²å®Œæˆ
    FAILED = "failed"        # å¤±è´¥
    CANCELLED = "cancelled"  # å·²å–æ¶ˆ

# ä»»åŠ¡æ•°æ®ç»“æ„
@dataclass
class Task:
    id: str                    # ä»»åŠ¡å”¯ä¸€æ ‡è¯† (UUID)
    prompt: str                # ä»»åŠ¡æè¿°/æç¤ºè¯
    workspace: str = "."       # å·¥ä½œç›®å½•
    timeout: int = 600000      # è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
    auto_approve: bool = False # æ˜¯å¦è‡ªåŠ¨æ‰¹å‡†å·¥å…·æ“ä½œ
    allowed_tools: list[str]   # å…è®¸ä½¿ç”¨çš„å·¥å…·åˆ—è¡¨
    status: TaskStatus         # ä»»åŠ¡çŠ¶æ€
    result: dict               # æ‰§è¡Œç»“æœ
    error: str                 # é”™è¯¯ä¿¡æ¯
    files_changed: list[str]   # å˜æ›´çš„æ–‡ä»¶åˆ—è¡¨
    tools_used: list[str]      # ä½¿ç”¨è¿‡çš„å·¥å…·åˆ—è¡¨

# å®šæ—¶ä»»åŠ¡æ•°æ®ç»“æ„
@dataclass
class ScheduledTask:
    id: str                    # ä»»åŠ¡å”¯ä¸€æ ‡è¯†
    name: str                  # ä»»åŠ¡åç§°
    prompt: str                # ä»»åŠ¡æè¿°/æç¤ºè¯
    cron: str                  # Cron è¡¨è¾¾å¼
    enabled: bool = True       # æ˜¯å¦å¯ç”¨
    last_run: str              # ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´
    next_run: str              # ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
    run_count: int = 0         # å·²æ‰§è¡Œæ¬¡æ•°
```

#### å­˜å‚¨å±‚ (`storage.py`)

æä¾› JSON æ–‡ä»¶å­˜å‚¨ï¼Œæ”¯æŒå¹¶å‘å®‰å…¨ï¼š

```python
from app.scheduler.storage import get_storage

# è·å–å­˜å‚¨å®ä¾‹
storage = get_storage()

# ä»»åŠ¡é˜Ÿåˆ—æ“ä½œ
storage.queue.add(task)           # æ·»åŠ ä»»åŠ¡åˆ°é˜Ÿåˆ—
storage.queue.get_all()           # è·å–æ‰€æœ‰é˜Ÿåˆ—ä»»åŠ¡
storage.queue.pop()               # å¼¹å‡ºé˜Ÿé¦–ä»»åŠ¡ï¼ˆFIFOï¼‰
storage.queue.remove(task_id)     # ç§»é™¤æŒ‡å®šä»»åŠ¡
storage.queue.clear()             # æ¸…ç©ºé˜Ÿåˆ—

# å®šæ—¶ä»»åŠ¡æ“ä½œ
storage.scheduled.save(task)      # ä¿å­˜æˆ–æ›´æ–°å®šæ—¶ä»»åŠ¡
storage.scheduled.get_all()       # è·å–æ‰€æœ‰å®šæ—¶ä»»åŠ¡
storage.scheduled.get_enabled()   # è·å–å·²å¯ç”¨çš„å®šæ—¶ä»»åŠ¡
storage.scheduled.delete(task_id) # åˆ é™¤å®šæ—¶ä»»åŠ¡

# è¿è¡Œä¸­ä»»åŠ¡ç®¡ç†
storage.running.add(task)         # æ·»åŠ è¿è¡Œä¸­ä»»åŠ¡
storage.running.update(task)      # æ›´æ–°è¿è¡Œä¸­ä»»åŠ¡
storage.running.remove(task_id)   # ç§»é™¤è¿è¡Œä¸­ä»»åŠ¡

# å†å²è®°å½•ï¼ˆåˆ†é¡µï¼‰
storage.history.get_completed(page=1, limit=20)
storage.history.get_failed(page=1, limit=20)
```

#### Cron è§£æå™¨ (`cron.py`)

æ”¯æŒ 5 ä½æ ‡å‡†æ ¼å¼å’Œ 6 ä½æ‰©å±•æ ¼å¼ï¼š

```python
from app.scheduler.cron import CronParser, is_due, format_next_run

parser = CronParser()

# è§£æ Cron è¡¨è¾¾å¼
expression = parser.parse("*/5 * * * *")  # æ¯ 5 åˆ†é’Ÿ

# éªŒè¯è¡¨è¾¾å¼
is_valid, error = parser.validate("0 9 * * 1-5")
# is_valid: True, error: None

# è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
next_run = parser.calculate_next_run("0 9 * * 1-5")
# è¿”å› datetime å¯¹è±¡

# è·å–æœªæ¥ n ä¸ªæ‰§è¡Œæ—¶é—´
next_runs = parser.get_next_runs("0 9 * * 1-5", count=5)

# åˆ¤æ–­æ˜¯å¦åˆ°æœŸ
if is_due(scheduled_task.next_run):
    # æ‰§è¡Œä»»åŠ¡
    pass

# æ ¼å¼åŒ–æ—¶é—´
formatted = format_next_run(next_run)  # "2026-02-26 09:00:00"
```

#### é…ç½®å¸¸é‡ (`config.py`)

```python
from app.scheduler.config import (
    DATA_DIR,           # æ•°æ®ç›®å½• "data/"
    DEFAULT_TIMEOUT,    # é»˜è®¤è¶…æ—¶ 600000ms (10åˆ†é’Ÿ)
    POLL_INTERVAL,      # è½®è¯¢é—´éš” 10ç§’
    MAX_RETRIES,        # æœ€å¤§é‡è¯•æ¬¡æ•° 2
    MAX_HISTORY,        # å†å²è®°å½•æœ€å¤§æ•°é‡ 1000
    SchedulerStatus,    # è°ƒåº¦å™¨çŠ¶æ€æšä¸¾
)
```

### Cron è¡¨è¾¾å¼è¯­æ³•

#### 5 ä½æ ‡å‡†æ ¼å¼

```
åˆ† æ—¶ æ—¥ æœˆ å‘¨
*  *  *  *  *
```

| å­—æ®µ | èŒƒå›´ | è¯´æ˜ |
|------|------|------|
| åˆ† | 0-59 | åˆ†é’Ÿ |
| æ—¶ | 0-23 | å°æ—¶ |
| æ—¥ | 1-31 | æ—¥æœŸ |
| æœˆ | 1-12 | æœˆä»½ |
| å‘¨ | 0-6 | æ˜ŸæœŸï¼ˆ0=å‘¨æ—¥ï¼‰ |

#### 6 ä½æ‰©å±•æ ¼å¼

```
ç§’ åˆ† æ—¶ æ—¥ æœˆ å‘¨
*  *  *  *  *  *
```

#### ç‰¹æ®Šå­—ç¬¦

| å­—ç¬¦ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `*` | ä»»æ„å€¼ | `* * * * *` æ¯åˆ†é’Ÿ |
| `/` | æ­¥è¿› | `*/5 * * * *` æ¯5åˆ†é’Ÿ |
| `-` | èŒƒå›´ | `0 9-17 * * *` 9ç‚¹åˆ°17ç‚¹ |
| `,` | åˆ—è¡¨ | `0 9,12,18 * * *` 9ã€12ã€18ç‚¹ |

#### é¢„å®šä¹‰åˆ«å

| åˆ«å | ç­‰ä»·äº | è¯´æ˜ |
|------|--------|------|
| `@yearly` | `0 0 1 1 *` | æ¯å¹´ |
| `@monthly` | `0 0 1 * *` | æ¯æœˆ |
| `@weekly` | `0 0 * * 0` | æ¯å‘¨ |
| `@daily` | `0 0 * * *` | æ¯å¤© |
| `@hourly` | `0 * * * *` | æ¯å°æ—¶ |

#### å¸¸ç”¨ç¤ºä¾‹

```bash
# æ¯ 5 åˆ†é’Ÿæ‰§è¡Œ
*/5 * * * *

# æ¯å¤©æ—©ä¸Š 9 ç‚¹
0 9 * * *

# å·¥ä½œæ—¥æ—©ä¸Š 9 ç‚¹
0 9 * * 1-5

# æ¯å°æ—¶æ•´ç‚¹
0 * * * *

# æ¯å‘¨ä¸€æ—©ä¸Š 9 ç‚¹
0 9 * * 1

# æ¯æœˆ 1 å·é›¶ç‚¹
0 0 1 * *

# æ¯ 30 ç§’ï¼ˆ6ä½æ ¼å¼ï¼‰
*/30 * * * * *
```

---

## æ·»åŠ æ–°åŠŸèƒ½

### æ·»åŠ æ–°çš„ API ç«¯ç‚¹

1. åœ¨ `app/main.py` ä¸­å®šä¹‰è·¯ç”±ï¼š

```python
@app.get("/api/custom")
async def custom_endpoint():
    return {"result": "success"}
```

2. å¦‚æœéœ€è¦æ–°çš„è¯·æ±‚æ¨¡å‹ï¼Œæ·»åŠ  Pydantic æ¨¡å‹ï¼š

```python
class CustomRequest(BaseModel):
    param1: str
    param2: Optional[int] = None
```

### æ·»åŠ æ–°çš„æ¶ˆæ¯ç±»å‹

1. åœ¨ `app/claude_runner/client.py` ä¸­æ‰©å±• `MessageType` æšä¸¾ï¼š

```python
class MessageType(Enum):
    TEXT = "text"
    TOOL_USE = "tool_use"
    # æ·»åŠ æ–°ç±»å‹
    CUSTOM = "custom"
```

2. åœ¨ `run_stream` æ–¹æ³•ä¸­å¤„ç†æ–°ç±»å‹ï¼š

```python
if custom_condition:
    stream_msg = StreamMessage(
        type=MessageType.CUSTOM,
        content="è‡ªå®šä¹‰å†…å®¹"
    )
```

3. åœ¨å‰ç«¯ `app/static/app.js` ä¸­å¤„ç†ï¼š

```javascript
handleStreamMessage(data) {
    switch (data.type) {
        case 'custom':
            this.addMessage('custom', data.content);
            break;
    }
}
```

### æ·»åŠ æ–°çš„èœå•é¡¹

1. åœ¨ `app/templates/index.html` ä¸­æ·»åŠ èœå•ï¼š

```html
<div class="nav-item" data-view="new-view">
    <span class="nav-icon">ğŸ†•</span>
    <span class="nav-text">æ–°åŠŸèƒ½</span>
</div>
```

2. æ·»åŠ å¯¹åº”è§†å›¾é¢æ¿ï¼š

```html
<div class="view-panel" id="view-new-view">
    <!-- è§†å›¾å†…å®¹ -->
</div>
```

3. åœ¨ `app/static/app.js` ä¸­å¤„ç†åˆ‡æ¢é€»è¾‘ã€‚

---

## ä¼šè¯å­˜å‚¨æœºåˆ¶

### å­˜å‚¨ä½ç½®

ä¼šè¯è®°å½•å­˜å‚¨åœ¨ Claude Code çš„é¡¹ç›®ç›®å½•ï¼š

```
~/.claude/projects/<encoded-path>/*.jsonl
```

### è·¯å¾„ç¼–ç è§„åˆ™

- Windows: `E:\workspaces\project` â†’ `E--workspaces-project`
- Unix: `/home/user/project` â†’ `-home-user-project`

### ä¼šè¯æ–‡ä»¶æ ¼å¼

æ¯è¡Œä¸€ä¸ª JSON å¯¹è±¡ï¼š

```json
{"type": "user", "message": {...}, "timestamp": "...", "sessionId": "..."}
{"type": "assistant", "message": {...}, "timestamp": "..."}
```

---

## æ ·å¼å¼€å‘

### CSS å˜é‡

```css
:root {
    --primary-color: #7c3aed;
    --primary-hover: #6d28d9;
    --success-color: #10b981;
    --danger-color: #ef4444;
    --warning-color: #f59e0b;
    --bg-color: #0f172a;
    --card-bg: #1e293b;
    --text-color: #e2e8f0;
    --text-muted: #94a3b8;
    --border-color: #334155;
}
```

### å“åº”å¼æ–­ç‚¹

```css
@media (max-width: 768px) {
    /* ç§»åŠ¨ç«¯æ ·å¼ */
}
```

---

## è°ƒè¯•æŠ€å·§

### åç«¯è°ƒè¯•

```python
# åœ¨ main.py ä¸­æ·»åŠ æ—¥å¿—
import logging
logging.basicConfig(level=logging.DEBUG)
```

### å‰ç«¯è°ƒè¯•

```javascript
// åœ¨ app.js ä¸­ä½¿ç”¨ console
console.log('Debug info:', data);
```

### æŸ¥çœ‹ SSE æµ

```bash
curl -N http://127.0.0.1:8000/api/task/stream \
  -H "Content-Type: application/json" \
  -d '{"prompt": "test"}'
```

---

## å¸¸è§é—®é¢˜

### Q: ä»»åŠ¡æ‰§è¡Œæ—¶çœ‹ä¸åˆ°è¾“å‡ºï¼Ÿ

æ£€æŸ¥ SSE è¿æ¥æ˜¯å¦æ­£å¸¸ï¼Œç¡®ä¿ä½¿ç”¨äº† `-N` å‚æ•°ï¼ˆcurlï¼‰æˆ–æ­£ç¡®å¤„ç†æµå¼å“åº”ã€‚

### Q: ä¼šè¯ ID æ— æ³•æ¢å¤ï¼Ÿ

ç¡®è®¤ä¼šè¯ ID æ­£ç¡®ï¼Œæ£€æŸ¥ `~/.claude/projects/` ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨å¯¹åº”çš„ä¼šè¯æ–‡ä»¶ã€‚

### Q: å·¥å…·è¢«æ‹’ç»ï¼Ÿ

æ£€æŸ¥ `allowed_tools` å‚æ•°ï¼Œç¡®ä¿åŒ…å«éœ€è¦çš„å·¥å…·ã€‚ä¹Ÿå¯ä»¥è®¾ç½® `permission_mode="bypassPermissions"`ã€‚

---

## å‘å¸ƒæ¸…å•

- [ ] æ›´æ–°ç‰ˆæœ¬å·
- [ ] è¿è¡Œæµ‹è¯•ç¡®ä¿é€šè¿‡
- [ ] æ›´æ–°æ–‡æ¡£
- [ ] æ£€æŸ¥ä¾èµ–ç‰ˆæœ¬
- [ ] åˆ›å»º Git æ ‡ç­¾

---

## v0.6.0 å®ç°ç¬”è®°

> è®°å½•ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿæ ¸å¿ƒæ¨¡å—çš„å®ç°ç»†èŠ‚ã€è®¾è®¡å†³ç­–å’Œæ³¨æ„äº‹é¡¹ã€‚

### å·²å®Œæˆæ¨¡å—æ¸…å•

| æ¨¡å— | è·¯å¾„ | è¡Œæ•° | çŠ¶æ€ |
|------|------|------|------|
| æ•°æ®æ¨¡å‹ | `app/scheduler/models.py` | 141 | âœ… |
| å­˜å‚¨å±‚ | `app/scheduler/storage.py` | 440 | âœ… |
| é…ç½®å¸¸é‡ | `app/scheduler/config.py` | 63 | âœ… |
| Cron è§£æå™¨ | `app/scheduler/cron.py` | 824 | âœ… |
| ä»»åŠ¡æ‰§è¡Œå™¨ | `app/scheduler/executor.py` | 494 | âœ… |
| ä¸»è°ƒåº¦å™¨ | `app/scheduler/scheduler.py` | 290 | âœ… |
| æ¨¡å‹æµ‹è¯• | `tests/test_scheduler_models.py` | 343 | âœ… |
| å­˜å‚¨æµ‹è¯• | `tests/test_scheduler_storage.py` | 451 | âœ… |
| Cron æµ‹è¯• | `tests/test_scheduler_cron.py` | - | âœ… |

### å…³é”®è®¾è®¡å†³ç­–

#### 1. è¶…æ—¶å•ä½ä½¿ç”¨æ¯«ç§’

```python
timeout: int = 600000  # 10 åˆ†é’Ÿï¼Œå•ä½æ¯«ç§’
```

**åŸå› **ï¼šä¸ JavaScript å‰ç«¯ä¿æŒä¸€è‡´ï¼Œé¿å…å•ä½è½¬æ¢é”™è¯¯ã€‚

#### 2. TaskStatus ç»§æ‰¿ str å’Œ Enum

```python
class TaskStatus(str, Enum):
    PENDING = "pending"
```

**åŸå› **ï¼šä¾¿äº JSON åºåˆ—åŒ–ï¼Œ`status.value` ç›´æ¥è¿”å›å­—ç¬¦ä¸²ã€‚

#### 3. æ—¶é—´å­—æ®µä½¿ç”¨ ISO æ ¼å¼å­—ç¬¦ä¸²

```python
created_at: str = field(default_factory=lambda: datetime.now().isoformat())
```

**åŸå› **ï¼šdatetime å¯¹è±¡æ— æ³•ç›´æ¥ JSON åºåˆ—åŒ–ï¼ŒISO å­—ç¬¦ä¸²é€šç”¨æ€§å¼ºã€‚

#### 4. æ–‡ä»¶é”ä½¿ç”¨åŸå­æ–‡ä»¶åˆ›å»º

```python
fd = os.open(lock_path, os.O_CREAT | os.O_EXCL | os.O_WRONLY)
```

**åŸå› **ï¼šUnix æ–‡ä»¶é”åœ¨ Windows ä¸Šä¸å¯ç”¨ï¼ŒåŸå­åˆ›å»ºè·¨å¹³å°å…¼å®¹ã€‚

### é‡åˆ°çš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

#### é—®é¢˜ 1ï¼šçŠ¶æ€æšä¸¾åºåˆ—åŒ–

- **é—®é¢˜**ï¼šæšä¸¾ç›´æ¥ JSON åºåˆ—åŒ–å¤±è´¥
- **è§£å†³**ï¼šç»§æ‰¿ `str` å’Œ `Enum`ï¼Œä½¿ç”¨ `.value` åºåˆ—åŒ–

#### é—®é¢˜ 2ï¼šWindows æ–‡ä»¶é”å…¼å®¹æ€§

- **é—®é¢˜**ï¼š`fcntl.flock()` ä»…é™ Unix ç³»ç»Ÿ
- **è§£å†³**ï¼šä½¿ç”¨ `os.O_CREAT | os.O_EXCL` åŸå­åˆ›å»ºé”æ–‡ä»¶

#### é—®é¢˜ 3ï¼šå†å²è®°å½•æ— é™å¢é•¿

- **é—®é¢˜**ï¼šå·²å®Œæˆ/å¤±è´¥ä»»åŠ¡ä¼šæŒç»­ç´¯ç§¯
- **è§£å†³**ï¼šè®¾ç½® `MAX_HISTORY = 1000`ï¼Œè‡ªåŠ¨æˆªæ–­æ—§è®°å½•

### å­˜å‚¨ç±»ç»“æ„

```
BaseStorage              # åŸºç±»ï¼šè¯»å†™ã€åŠ é”
    â”œâ”€â”€ QueueStorage     # ä»»åŠ¡é˜Ÿåˆ—ï¼šFIFO æ“ä½œ
    â”œâ”€â”€ ScheduledStorage # å®šæ—¶ä»»åŠ¡ï¼šCRUD + å¯ç”¨è¿‡æ»¤
    â”œâ”€â”€ RunningStorage   # è¿è¡Œä¸­ï¼šçŠ¶æ€è·Ÿè¸ª
    â””â”€â”€ HistoryStorage   # å†å²è®°å½•ï¼šåˆ†é¡µ + é™åˆ¶æ•°é‡
```

### é…ç½®å¸¸é‡é€ŸæŸ¥

```python
# è¶…æ—¶é…ç½®
DEFAULT_TIMEOUT = 600000  # 10 åˆ†é’Ÿ
MIN_TIMEOUT = 1000        # 1 ç§’
MAX_TIMEOUT = 3600000     # 1 å°æ—¶

# è°ƒåº¦é…ç½®
POLL_INTERVAL = 10        # è½®è¯¢é—´éš”ï¼ˆç§’ï¼‰
MAX_RETRIES = 2           # æœ€å¤§é‡è¯•æ¬¡æ•°
MAX_HISTORY = 1000        # å†å²è®°å½•ä¸Šé™

# åˆ†é¡µé…ç½®
DEFAULT_LIMIT = 20
MAX_LIMIT = 100

# é”é…ç½®
LOCK_TIMEOUT = 5          # é”è¶…æ—¶ï¼ˆç§’ï¼‰
LOCK_RETRY_INTERVAL = 0.1 # é‡è¯•é—´éš”ï¼ˆç§’ï¼‰
MAX_LOCK_RETRIES = 50     # æœ€å¤§é‡è¯•æ¬¡æ•°
```

### æµ‹è¯•å‘½ä»¤

```bash
# è¿è¡Œè°ƒåº¦å™¨æµ‹è¯•
uv run pytest tests/test_scheduler*.py -v

# æ˜¾ç¤ºè¦†ç›–ç‡
uv run pytest tests/test_scheduler*.py -v --cov=app/scheduler
```

### åç»­å·¥ä½œ (v0.6.2+)

1. ~~**å®šæ—¶ä»»åŠ¡åˆ°æœŸæ£€æŸ¥** - å®ç°å®šæ—¶ä»»åŠ¡åˆ°æœŸè‡ªåŠ¨åŠ å…¥é˜Ÿåˆ—~~ âœ…
2. ~~**ä»»åŠ¡æ‰§è¡Œå™¨** - `executor.py` è°ƒç”¨ ClaudeCodeClient~~ âœ…
3. ~~**ä¸»è°ƒåº¦å™¨** - `scheduler.py` è½®è¯¢å’ŒçŠ¶æ€ç®¡ç†~~ âœ…
4. **API è·¯ç”±** - `routers/scheduler.py` REST API ç«¯ç‚¹
5. **å‰ç«¯è§†å›¾** - ä»»åŠ¡è°ƒåº¦ç®¡ç†ç•Œé¢

---

## è°ƒåº¦å™¨é…ç½®è¯´æ˜

> è¯¦ç»†çš„è°ƒåº¦å™¨é…ç½®å‚æ•°å’Œä½¿ç”¨æŒ‡å—ã€‚

### é…ç½®æ–‡ä»¶ä½ç½®

è°ƒåº¦å™¨é…ç½®å®šä¹‰åœ¨ `app/scheduler/config.py` ä¸­ï¼š

```python
from app.scheduler.config import (
    # æ•°æ®ç›®å½•
    DATA_DIR,           # Path("data")

    # æ•°æ®æ–‡ä»¶
    QUEUE_FILE,         # data/queue.json
    SCHEDULED_FILE,     # data/scheduled.json
    RUNNING_FILE,       # data/running.json
    COMPLETED_FILE,     # data/completed.json
    FAILED_FILE,        # data/failed.json

    # è¶…æ—¶é…ç½®
    DEFAULT_TIMEOUT,    # 600000 (10åˆ†é’Ÿ)
    MIN_TIMEOUT,        # 1000 (1ç§’)
    MAX_TIMEOUT,        # 3600000 (1å°æ—¶)

    # è°ƒåº¦é…ç½®
    POLL_INTERVAL,      # 10 (ç§’)
    MAX_RETRIES,        # 2
    MAX_HISTORY,        # 1000

    # åˆ†é¡µé…ç½®
    DEFAULT_PAGE,       # 1
    DEFAULT_LIMIT,      # 20
    MAX_LIMIT,          # 100

    # é”é…ç½®
    LOCK_TIMEOUT,       # 5 (ç§’)
    LOCK_RETRY_INTERVAL,# 0.1 (ç§’)
    MAX_LOCK_RETRIES,   # 50

    # çŠ¶æ€æšä¸¾
    SchedulerStatus,
)
```

### æ ¸å¿ƒé…ç½®è¯¦è§£

#### è¶…æ—¶é…ç½®

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `DEFAULT_TIMEOUT` | 600000 (10åˆ†é’Ÿ) | æ–°ä»»åŠ¡çš„é»˜è®¤è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ |
| `MIN_TIMEOUT` | 1000 (1ç§’) | å…è®¸çš„æœ€å°è¶…æ—¶æ—¶é—´ |
| `MAX_TIMEOUT` | 3600000 (1å°æ—¶) | å…è®¸çš„æœ€å¤§è¶…æ—¶æ—¶é—´ |

**ä¿®æ”¹æ–¹å¼**ï¼šç›´æ¥ä¿®æ”¹ `config.py` æˆ–åœ¨åˆ›å»ºä»»åŠ¡æ—¶æŒ‡å®š `timeout` å‚æ•°ã€‚

```python
# åˆ›å»ºä»»åŠ¡æ—¶æŒ‡å®šè¶…æ—¶ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰
task = Task(
    id=str(uuid.uuid4()),
    prompt="æ‰§è¡Œä»»åŠ¡",
    timeout=300000,  # 5 åˆ†é’Ÿ
)
```

#### è°ƒåº¦é…ç½®

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `POLL_INTERVAL` | 10 | è°ƒåº¦å™¨è½®è¯¢é—´éš”ï¼ˆç§’ï¼‰ |
| `MAX_RETRIES` | 2 | ä»»åŠ¡å¤±è´¥åæœ€å¤§é‡è¯•æ¬¡æ•° |
| `MAX_HISTORY` | 1000 | å†å²è®°å½•æœ€å¤§ä¿ç•™æ•°é‡ |

**è°ƒæ•´è½®è¯¢é—´éš”**ï¼š

```python
from app.scheduler import Scheduler

# åˆ›å»ºè°ƒåº¦å™¨æ—¶æŒ‡å®šè½®è¯¢é—´éš”
scheduler = Scheduler(poll_interval=5)  # 5 ç§’è½®è¯¢ä¸€æ¬¡
```

#### åˆ†é¡µé…ç½®

| å‚æ•° | é»˜è®¤å€¼ | æœ€å¤§å€¼ | è¯´æ˜ |
|------|--------|--------|------|
| `DEFAULT_PAGE` | 1 | - | é»˜è®¤é¡µç  |
| `DEFAULT_LIMIT` | 20 | - | é»˜è®¤æ¯é¡µæ•°é‡ |
| `MAX_LIMIT` | 100 | - | æœ€å¤§æ¯é¡µæ•°é‡ |

### è°ƒåº¦å™¨çŠ¶æ€

`SchedulerStatus` æšä¸¾å®šä¹‰äº†è°ƒåº¦å™¨çš„å››ç§çŠ¶æ€ï¼š

| çŠ¶æ€ | å€¼ | è¯´æ˜ |
|------|-----|------|
| `STOPPED` | "stopped" | å·²åœæ­¢ |
| `RUNNING` | "running" | è¿è¡Œä¸­ |
| `STARTING` | "starting" | å¯åŠ¨ä¸­ |
| `STOPPING` | "stopping" | åœæ­¢ä¸­ |

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
from app.scheduler import get_scheduler, SchedulerStatus

scheduler = get_scheduler()

# æ£€æŸ¥çŠ¶æ€
if scheduler.status == SchedulerStatus.RUNNING:
    print("è°ƒåº¦å™¨æ­£åœ¨è¿è¡Œ")

# è·å–è¯¦ç»†çŠ¶æ€ä¿¡æ¯
info = scheduler.get_status_info()
# {
#     "status": "running",
#     "poll_interval": 10,
#     "queue_count": 5,
#     "scheduled_count": 3,
#     "enabled_scheduled_count": 2,
#     "running_count": 1,
#     "is_executing": True,
#     "current_task_id": "...",
#     "updated_at": "2026-02-26T12:00:00"
# }
```

### æ‰§è¡Œå™¨é…ç½®

æ‰§è¡Œå™¨ï¼ˆ`TaskExecutor`ï¼‰è´Ÿè´£å®é™…æ‰§è¡Œä»»åŠ¡ï¼Œé…ç½®å‚æ•°åŒ…æ‹¬ï¼š

#### é‡è¯•å»¶è¿Ÿé…ç½®

åœ¨ `app/scheduler/executor.py` ä¸­å®šä¹‰ï¼š

```python
BASE_DELAY = 5.0       # åŸºç¡€å»¶è¿Ÿï¼ˆç§’ï¼‰
MAX_DELAY = 60.0       # æœ€å¤§å»¶è¿Ÿï¼ˆç§’ï¼‰
JITTER = 0.1           # æŠ–åŠ¨å› å­ï¼ˆÂ±10%ï¼‰
```

**æŒ‡æ•°é€€é¿ç®—æ³•**ï¼š

```
delay = base_delay Ã— 2^retry_count + jitter
delay = min(delay, max_delay)
```

| é‡è¯•æ¬¡æ•° | åŸºç¡€å»¶è¿Ÿ | å®é™…å»¶è¿ŸèŒƒå›´ |
|---------|---------|-------------|
| 1 | 5 ç§’ | 4.5 ~ 5.5 ç§’ |
| 2 | 10 ç§’ | 9 ~ 11 ç§’ |
| 3+ | 20 ç§’ï¼ˆé™åˆ¶ï¼‰ | 18 ~ 22 ç§’ |

#### é”™è¯¯åˆ†ç±»

æ‰§è¡Œå™¨å°†é”™è¯¯åˆ†ä¸ºä»¥ä¸‹ç±»å‹ï¼š

| ç±»å‹ | å¯é‡è¯• | è¯´æ˜ |
|------|--------|------|
| `TRANSIENT` | âœ… | ä¸´æ—¶æ€§é”™è¯¯ |
| `TIMEOUT` | âœ… | è¶…æ—¶é”™è¯¯ |
| `RESOURCE` | âœ… | èµ„æºé”™è¯¯ï¼ˆç½‘ç»œã€é™æµï¼‰ |
| `PERMANENT` | âŒ | æ°¸ä¹…æ€§é”™è¯¯ |
| `USER_CANCEL` | âŒ | ç”¨æˆ·å–æ¶ˆ |
| `VALIDATION` | âŒ | éªŒè¯é”™è¯¯ |

### æ•°æ®å­˜å‚¨é…ç½®

#### å­˜å‚¨ç›®å½•

é»˜è®¤æ•°æ®å­˜å‚¨åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `data/` æ–‡ä»¶å¤¹ï¼š

```
data/
â”œâ”€â”€ queue.json       # ä»»åŠ¡é˜Ÿåˆ—
â”œâ”€â”€ scheduled.json   # å®šæ—¶ä»»åŠ¡
â”œâ”€â”€ running.json     # è¿è¡Œä¸­ä»»åŠ¡
â”œâ”€â”€ completed.json   # å·²å®Œæˆä»»åŠ¡
â””â”€â”€ failed.json      # å¤±è´¥ä»»åŠ¡
```

#### æ–‡ä»¶é”é…ç½®

ä¸ºç¡®ä¿å¹¶å‘å®‰å…¨ï¼Œå­˜å‚¨å±‚ä½¿ç”¨æ–‡ä»¶é”ï¼š

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `LOCK_TIMEOUT` | 5 | é”è·å–è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |
| `LOCK_RETRY_INTERVAL` | 0.1 | é”é‡è¯•é—´éš”ï¼ˆç§’ï¼‰ |
| `MAX_LOCK_RETRIES` | 50 | æœ€å¤§é‡è¯•æ¬¡æ•° |

### å¸¸ç”¨é…ç½®åœºæ™¯

#### åœºæ™¯ 1ï¼šæé«˜è°ƒåº¦é¢‘ç‡

é€‚ç”¨äºéœ€è¦å¿«é€Ÿå“åº”çš„åœºæ™¯ï¼š

```python
from app.scheduler import Scheduler

scheduler = Scheduler(poll_interval=5)  # 5 ç§’æ£€æŸ¥ä¸€æ¬¡
await scheduler.start()
```

#### åœºæ™¯ 2ï¼šå»¶é•¿ä»»åŠ¡è¶…æ—¶

é€‚ç”¨äºé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ï¼š

```python
task = Task(
    id=str(uuid.uuid4()),
    prompt="æ‰§è¡Œå¤æ‚åˆ†æä»»åŠ¡",
    timeout=1800000,  # 30 åˆ†é’Ÿ
)
```

#### åœºæ™¯ 3ï¼šç¦ç”¨è‡ªåŠ¨é‡è¯•

åœ¨ `executor.py` ä¸­ä¿®æ”¹ï¼š

```python
MAX_RETRIES = 0  # ç¦ç”¨é‡è¯•
```

æˆ–ä¿®æ”¹ `RETRYABLE_ERRORS` é›†åˆï¼š

```python
RETRYABLE_ERRORS: set[ErrorType] = {
    # ErrorType.TRANSIENT,  # ç§»é™¤ä¸´æ—¶æ€§é”™è¯¯
    ErrorType.TIMEOUT,      # ä»…ä¿ç•™è¶…æ—¶é‡è¯•
    # ErrorType.RESOURCE,   # ç§»é™¤èµ„æºé”™è¯¯
}
```

### æ€§èƒ½è°ƒä¼˜å»ºè®®

| åœºæ™¯ | å»ºè®®é…ç½® |
|------|---------|
| é«˜é¢‘è°ƒåº¦ | `POLL_INTERVAL = 5` |
| é•¿æ—¶ä»»åŠ¡ | `MAX_TIMEOUT = 7200000` (2å°æ—¶) |
| å¤§é‡å†å² | `MAX_HISTORY = 5000` |
| å¹¶å‘å®‰å…¨ | `LOCK_TIMEOUT = 10` |

### ç›‘æ§ä¸æ—¥å¿—

è°ƒåº¦å™¨å’Œæ‰§è¡Œå™¨ä½¿ç”¨ Python æ ‡å‡†æ—¥å¿—ï¼š

```python
import logging

# å¯ç”¨è°ƒè¯•æ—¥å¿—
logging.getLogger("app.scheduler").setLevel(logging.DEBUG)
```

æ—¥å¿—è¾“å‡ºç¤ºä¾‹ï¼š

```
INFO:app.scheduler.scheduler:è°ƒåº¦å™¨å·²å¯åŠ¨ï¼Œè½®è¯¢é—´éš”: 10ç§’
INFO:app.scheduler.scheduler:å®šæ—¶ä»»åŠ¡åˆ°æœŸ: æ¯æ—¥ä»£ç å®¡æŸ¥ (abc-123)
INFO:app.scheduler.scheduler:å®šæ—¶ä»»åŠ¡å·²åŠ å…¥é˜Ÿåˆ—: def-456
INFO:app.scheduler.executor:Task def-456 started: æ‰§è¡Œä»£ç å®¡æŸ¥...
INFO:app.scheduler.executor:Task def-456 completed in 45000ms, cost: $0.0234
```

### å·²çŸ¥é—®é¢˜å’Œé™åˆ¶

> è®°å½•ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿçš„å·²çŸ¥é—®é¢˜ã€åŠŸèƒ½é™åˆ¶å’Œæœªæ¥æ”¹è¿›æ–¹å‘ã€‚
> **æœ€åæ›´æ–°**: 2026-02-27

#### åŠŸèƒ½é™åˆ¶

| é™åˆ¶é¡¹ | å½“å‰å€¼ | è¯´æ˜ |
|--------|--------|------|
| å•æœºéƒ¨ç½² | - | å½“å‰ JSON æ–‡ä»¶å­˜å‚¨æ–¹æ¡ˆä¸æ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²ï¼Œæ— æ³•å¤šå®ä¾‹å…±äº«æ•°æ® |
| æ— å†…å­˜ç¼“å­˜ | - | æ¯æ¬¡æ“ä½œéƒ½ç›´æ¥è¯»å†™æ–‡ä»¶ï¼Œé¢‘ç¹æ“ä½œå¯èƒ½å½±å“æ€§èƒ½ |
| æ— ä»»åŠ¡ä¼˜å…ˆçº§ | - | ä»»åŠ¡æŒ‰ FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰é¡ºåºæ‰§è¡Œï¼Œä¸æ”¯æŒä¼˜å…ˆçº§è°ƒåº¦ |
| æ— ä»»åŠ¡å–æ¶ˆ | - | åç«¯ API ä¸æ”¯æŒå–æ¶ˆæ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ |
| å†å²è®°å½•ä¸Šé™ | 1000 æ¡ | å·²å®Œæˆå’Œå¤±è´¥ä»»åŠ¡å„æœ€å¤šä¿ç•™ 1000 æ¡ï¼Œè¶…å‡ºè‡ªåŠ¨æˆªæ–­ |
| è¶…æ—¶æ—¶é—´èŒƒå›´ | 1ç§’ - 1å°æ—¶ | ä»»åŠ¡è¶…æ—¶æ—¶é—´å¿…é¡»åœ¨ `MIN_TIMEOUT` å’Œ `MAX_TIMEOUT` ä¹‹é—´ |
| æœ€å¤§é‡è¯•æ¬¡æ•° | 2 æ¬¡ | ä»»åŠ¡å¤±è´¥åæœ€å¤šé‡è¯• 2 æ¬¡ï¼Œä¹‹åæ ‡è®°ä¸ºå¤±è´¥ |
| æ— æŒä¹…åŒ–é‡è¯•çŠ¶æ€ | - | é‡è¯•å»¶è¿ŸæœŸé—´æœåŠ¡é‡å¯ä¼šä¸¢å¤±é‡è¯•çŠ¶æ€ |

#### API é™åˆ¶

| å‚æ•° | é™åˆ¶ | è¯´æ˜ |
|------|------|------|
| prompt é•¿åº¦ | â‰¤ 10000 å­—ç¬¦ | ä»»åŠ¡æè¿°è¶…è¿‡é™åˆ¶ä¼šè¿”å› 400 é”™è¯¯ |
| name é•¿åº¦ | â‰¤ 100 å­—ç¬¦ | å®šæ—¶ä»»åŠ¡åç§°è¶…è¿‡é™åˆ¶ä¼šè¿”å› 400 é”™è¯¯ |
| åˆ†é¡µ limit | â‰¤ 100 | å•æ¬¡æŸ¥è¯¢æœ€å¤šè¿”å› 100 æ¡è®°å½• |
| å·¥ä½œç›®å½• | å¿…é¡»åœ¨å…è®¸èŒƒå›´å†… | è·¯å¾„éå†æ”»å‡»é˜²æŠ¤ï¼Œå·¥ä½œç›®å½•å¿…é¡»åœ¨ `WORKING_DIR` é…ç½®çš„ç›®å½•å†… |

#### Cron è¡¨è¾¾å¼é™åˆ¶

| é™åˆ¶é¡¹ | è¯´æ˜ |
|--------|------|
| ä¸æ”¯æŒé¢„å®šä¹‰åˆ«å | `@yearly`ã€`@monthly` ç­‰åˆ«åæš‚ä¸æ”¯æŒ |
| ä¸æ”¯æŒ `L`ï¼ˆæœ€åä¸€å¤©ï¼‰ | æœˆæœ«æ—¥æœŸï¼ˆå¦‚ `L` è¡¨ç¤ºæœˆæœ«ï¼‰æš‚ä¸æ”¯æŒ |
| ä¸æ”¯æŒ `W`ï¼ˆå·¥ä½œæ—¥ï¼‰ | æœ€è¿‘å·¥ä½œæ—¥è®¡ç®—æš‚ä¸æ”¯æŒ |
| ä¸æ”¯æŒ `#`ï¼ˆç¬¬Nä¸ªå‘¨å‡ ï¼‰ | å¦‚ `0 9 * * 1#3`ï¼ˆç¬¬ä¸‰ä¸ªå‘¨ä¸€ï¼‰æš‚ä¸æ”¯æŒ |

#### å‰ç«¯é™åˆ¶

| é™åˆ¶é¡¹ | è¯´æ˜ |
|--------|------|
| æ— ä»»åŠ¡å–æ¶ˆæŒ‰é’® | ç”±äºåç«¯ API ä¸æ”¯æŒï¼Œè¿è¡Œä¸­ä»»åŠ¡åˆ—è¡¨æ²¡æœ‰å–æ¶ˆæŒ‰é’® |
| è½®è¯¢æ›´æ–° | ä½¿ç”¨ 5 ç§’è½®è¯¢åˆ·æ–°æ•°æ®ï¼Œéå®æ—¶ WebSocket æ¨é€ |
| æ— ç¦»çº¿æ”¯æŒ | ç½‘ç»œæ–­å¼€åæ— æ³•æŸ¥çœ‹ç¼“å­˜æ•°æ® |
| å“åº”å¼è®¾è®¡ | < 768px å°å±å¹•ä¸‹éƒ¨åˆ†è¡¨æ ¼åˆ—å¯èƒ½è¢«éšè— |

#### å·²çŸ¥é—®é¢˜

1. **Windows æ–‡ä»¶é”æ€§èƒ½** - Windows å¹³å°ä½¿ç”¨åŸå­æ–‡ä»¶åˆ›å»ºå®ç°é”æœºåˆ¶ï¼Œé«˜å¹¶å‘åœºæ™¯ä¸‹å¯èƒ½å‡ºç°é”ç­‰å¾…è¶…æ—¶
2. **å¤§é‡å†å²æ•°æ®åˆ†é¡µ** - å†å²è®°å½•è¶…è¿‡ 1000 æ¡æ—¶ï¼Œåˆ†é¡µæŸ¥è¯¢å¯èƒ½å˜æ…¢
3. **é«˜é¢‘è½®è¯¢å¼€é”€** - é»˜è®¤ 10 ç§’è½®è¯¢é—´éš”ï¼Œå¤§é‡å®šæ—¶ä»»åŠ¡æ£€æŸ¥å¯èƒ½æœ‰æ€§èƒ½å¼€é”€
4. **è·¨å¹³å°è·¯å¾„å¤„ç†** - Windows å’Œ Unix è·¯å¾„åˆ†éš”ç¬¦å·®å¼‚éœ€æ³¨æ„
5. **æ—¶åŒºå¤„ç†** - æ‰€æœ‰æ—¶é—´ä½¿ç”¨æœ¬åœ°æ—¶åŒºï¼Œä¸æ”¯æŒæŒ‡å®šæ—¶åŒº
6. **é‡è¯•å»¶è¿Ÿä¸æŒä¹…åŒ–** - æœåŠ¡é‡å¯åé‡è¯•å»¶è¿ŸçŠ¶æ€ä¸¢å¤±

#### å®‰å…¨æªæ–½

| æªæ–½ | è¯´æ˜ |
|------|------|
| è·¯å¾„éå†é˜²æŠ¤ | `validate_workspace()` é˜²æ­¢è®¿é—®å…è®¸ç›®å½•å¤–çš„è·¯å¾„ |
| è¾“å…¥éªŒè¯ | promptã€nameã€timeoutã€tools ç­‰å­—æ®µä¸¥æ ¼éªŒè¯ |
| XSS é˜²æŠ¤ | å‰ç«¯ä½¿ç”¨ `textContent` è½¬ä¹‰ç”¨æˆ·è¾“å…¥ |
| CSRF é˜²æŠ¤ | FastAPI å†…ç½® CSRF é˜²æŠ¤ |
| å¯é€‰è®¤è¯ | æ”¯æŒ OAuth2 å¯é€‰è®¤è¯ |

#### æœªæ¥æ”¹è¿›æ–¹å‘

**v0.7.x è®¡åˆ’**:
- åˆ†å¸ƒå¼æ”¯æŒï¼ˆRedis æˆ–æ•°æ®åº“ï¼‰
- ä»»åŠ¡ä¼˜å…ˆçº§é˜Ÿåˆ—
- ä»»åŠ¡å–æ¶ˆåŠŸèƒ½
- WebSocket å®æ—¶æ¨é€
- Cron åˆ«åæ”¯æŒ

**v0.8.x è®¡åˆ’**:
- ä»»åŠ¡ä¾èµ–å…³ç³»
- ä»»åŠ¡æ¨¡æ¿
- æ‰§è¡Œæ—¥å¿—å›æ”¾
- æ€§èƒ½ç›‘æ§
- å›½é™…åŒ–æ”¯æŒ

---

## v0.6.7 æµ‹è¯•æ–¹æ¡ˆè®¾è®¡

> ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿçš„æµ‹è¯•ç­–ç•¥ã€æµ‹è¯•ç”¨ä¾‹å’ŒéªŒæ”¶æ ‡å‡†ã€‚

### æµ‹è¯•æ¦‚è§ˆ

#### æµ‹è¯•èŒƒå›´

| æ¨¡å— | æµ‹è¯•æ–‡ä»¶ | è¦†ç›–å†…å®¹ |
|------|----------|----------|
| æ•°æ®æ¨¡å‹ | test_scheduler_models.py | Taskã€ScheduledTaskã€TaskStatusã€PaginatedResponse |
| Cron è§£æ | test_scheduler_cron.py | CronParserã€è¡¨è¾¾å¼è§£æã€ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´è®¡ç®— |
| å­˜å‚¨å±‚ | test_scheduler_storage.py | JSON æ–‡ä»¶å­˜å‚¨ã€é˜Ÿåˆ—æ“ä½œã€å†å²è®°å½• |
| æ‰§è¡Œå™¨ | test_scheduler_executor.py | ä»»åŠ¡æ‰§è¡Œã€è¶…æ—¶æ§åˆ¶ã€é‡è¯•æœºåˆ¶ã€é”™è¯¯å¤„ç† |
| é›†æˆæµ‹è¯• | test_scheduler_integration.py | è°ƒåº¦å™¨è½®è¯¢ã€å®šæ—¶ä»»åŠ¡è§¦å‘ã€å¯åŠ¨/åœæ­¢ |
| API æµ‹è¯• | test_scheduler_api.py | REST API ç«¯ç‚¹ã€è¯·æ±‚éªŒè¯ã€å“åº”æ ¼å¼ |

#### æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡

| ç±»å‹ | ç›®æ ‡è¦†ç›–ç‡ | å½“å‰çŠ¶æ€ |
|------|-----------|----------|
| å•å…ƒæµ‹è¯• | â‰¥ 90% | âœ… å·²å®ç° |
| é›†æˆæµ‹è¯• | â‰¥ 80% | âœ… å·²å®ç° |
| API æµ‹è¯• | â‰¥ 85% | âœ… å·²å®ç° |
| ç«¯åˆ°ç«¯æµ‹è¯• | å…³é”®æµç¨‹ | âš ï¸ å¾…å®Œå–„ |

### å•å…ƒæµ‹è¯•ç­–ç•¥

#### æ•°æ®æ¨¡å‹æµ‹è¯•

```python
class TestTask:
    """Task æ•°æ®æ¨¡å‹æµ‹è¯•"""
    def test_task_creation(self)        # æµ‹è¯•ä»»åŠ¡åˆ›å»º
    def test_task_default_values(self)  # æµ‹è¯•ä»»åŠ¡é»˜è®¤å€¼
    def test_task_to_dict(self)         # æµ‹è¯•ä»»åŠ¡è½¬å­—å…¸
    def test_task_from_dict(self)       # æµ‹è¯•ä»å­—å…¸åˆ›å»ºä»»åŠ¡
    def test_task_round_trip(self)      # æµ‹è¯•ä»»åŠ¡åºåˆ—åŒ–å¾€è¿”

class TestScheduledTask:
    """ScheduledTask æ•°æ®æ¨¡å‹æµ‹è¯•"""
    def test_scheduled_task_creation(self)
    def test_scheduled_task_default_values(self)
    def test_scheduled_task_round_trip(self)

class TestPaginatedResponse:
    """PaginatedResponse æµ‹è¯•"""
    def test_paginated_response_creation(self)
    def test_paginated_response_first_page(self)
    def test_paginated_response_empty(self)
```

#### Cron è§£æå™¨æµ‹è¯•

```python
class TestCronParserStandardFormat:
    """æµ‹è¯•æ ‡å‡†æ ¼å¼ï¼ˆ5ä½ï¼‰è§£æ"""
    def test_parse_standard_format_basic(self)
    def test_parse_all_wildcards(self)
    def test_parse_fixed_values(self)

class TestCronSpecialCharacters:
    """æµ‹è¯•ç‰¹æ®Šå­—ç¬¦è§£æ"""
    def test_wildcard_character(self)    # æµ‹è¯•é€šé…ç¬¦ *
    def test_step_character(self)        # æµ‹è¯•æ­¥è¿›å­—ç¬¦ /
    def test_range_character(self)       # æµ‹è¯•èŒƒå›´å­—ç¬¦ -
    def test_list_character(self)        # æµ‹è¯•åˆ—è¡¨å­—ç¬¦ ,

class TestCronValidation:
    """æµ‹è¯• Cron è¡¨è¾¾å¼éªŒè¯"""
    def test_validate_valid_expression(self)
    def test_validate_invalid_field_count(self)
    def test_validate_invalid_value(self)

class TestCalculateNextRun:
    """æµ‹è¯•ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´è®¡ç®—"""
    def test_calculate_next_run_hourly(self)
    def test_calculate_next_run_daily(self)
    def test_calculate_next_run_already_passed_today(self)

class TestEdgeCases:
    """æµ‹è¯•è¾¹ç•Œæ¡ä»¶"""
    def test_year_boundary(self)         # æµ‹è¯•è·¨å¹´è¾¹ç•Œ
    def test_month_boundary(self)        # æµ‹è¯•è·¨æœˆè¾¹ç•Œ
    def test_february_last_day(self)     # æµ‹è¯• 2 æœˆæœ«å°¾
```

#### æ‰§è¡Œå™¨æµ‹è¯•

```python
class TestErrorCollector:
    """é”™è¯¯æ”¶é›†å™¨æµ‹è¯•"""
    def test_error_collector_creation(self)
    def test_error_collector_add_error(self)
    def test_error_collector_multiple_errors(self)

class TestClassifyError:
    """é”™è¯¯åˆ†ç±»æµ‹è¯•"""
    def test_classify_timeout_error(self)
    def test_classify_resource_error_rate_limit(self)
    def test_classify_validation_error_invalid(self)

class TestShouldRetry:
    """ä»»åŠ¡é‡è¯•åˆ¤æ–­æµ‹è¯•"""
    def test_should_retry_within_limit(self)
    def test_should_retry_at_limit(self)
    def test_should_not_retry_validation_error(self)

class TestCalculateRetryDelay:
    """é‡è¯•å»¶è¿Ÿè®¡ç®—æµ‹è¯•"""
    def test_retry_delay_first_retry(self)   # delay = 5 * 2^0
    def test_retry_delay_second_retry(self)  # delay = 5 * 2^1
    def test_retry_delay_max_cap(self)       # delay â‰¤ MAX_DELAY

class TestTaskExecutor:
    """ä»»åŠ¡æ‰§è¡Œå™¨æµ‹è¯•"""
    def test_validate_task_empty_prompt(self)
    def test_validate_task_timeout_too_small(self)
    async def test_execute_success(self)
    async def test_execute_timeout(self)
    async def test_execute_retry_on_transient_error(self)
    async def test_execute_max_retries_exceeded(self)
```

### é›†æˆæµ‹è¯•ç­–ç•¥

#### è°ƒåº¦å™¨é›†æˆæµ‹è¯•

```python
class TestSchedulerStatus:
    """è°ƒåº¦å™¨çŠ¶æ€ç®¡ç†æµ‹è¯•"""
    def test_initial_status_stopped(self)
    def test_get_status_info(self)
    def test_get_status_info_with_running_task(self)

class TestSchedulerStartStop:
    """è°ƒåº¦å™¨å¯åŠ¨/åœæ­¢æµ‹è¯•"""
    async def test_start_scheduler(self)
    async def test_start_already_running(self)
    async def test_stop_scheduler(self)
    async def test_start_stop_cycle(self)

class TestScheduledTaskTrigger:
    """å®šæ—¶ä»»åŠ¡åˆ°æœŸè§¦å‘æµ‹è¯•"""
    async def test_trigger_scheduled_task(self)
    async def test_check_scheduled_tasks_due(self)
    async def test_check_scheduled_tasks_not_due(self)
    async def test_check_multiple_scheduled_tasks(self)

class TestQueueProcessing:
    """é˜Ÿåˆ—ä»»åŠ¡æ‰§è¡Œæµ‹è¯•"""
    async def test_process_queue_with_task(self)
    async def test_process_queue_empty(self)
    async def test_execute_task_success(self)
    async def test_execute_task_failure(self)

class TestRunLoop:
    """è°ƒåº¦å¾ªç¯æµ‹è¯•"""
    async def test_run_loop_processes_queue(self)
    async def test_run_loop_checks_scheduled_tasks(self)
    async def test_run_loop_continues_on_exception(self)
```

### API æµ‹è¯•ç­–ç•¥

#### ä»»åŠ¡é˜Ÿåˆ—ç®¡ç† API

```python
class TestTaskQueueAPI:
    def test_create_task_success(self)
    def test_create_task_with_empty_prompt(self)
    def test_list_tasks_empty(self)
    def test_list_tasks_with_tasks(self)
    def test_delete_task_success(self)
    def test_delete_task_not_found(self)
    def test_clear_tasks_success(self)
```

#### å®šæ—¶ä»»åŠ¡ç®¡ç† API

```python
class TestScheduledTaskAPI:
    def test_create_scheduled_task_success(self)
    def test_create_scheduled_task_with_invalid_cron(self)
    def test_list_scheduled_tasks_empty(self)
    def test_update_scheduled_task_success(self)
    def test_delete_scheduled_task_success(self)
    def test_toggle_scheduled_task_enable(self)
    def test_toggle_scheduled_task_disable(self)
```

#### è°ƒåº¦å™¨æ§åˆ¶ API

```python
class TestSchedulerControlAPI:
    def test_get_scheduler_status_success(self)
    def test_start_scheduler_success(self)
    def test_start_scheduler_already_running(self)
    def test_stop_scheduler_success(self)
    def test_stop_scheduler_already_stopped(self)
```

#### Cron éªŒè¯ API

```python
class TestCronValidationAPI:
    def test_validate_cron_success(self)
    def test_validate_cron_empty(self)
    def test_validate_cron_invalid(self)
    def test_get_cron_examples(self)
```

### ç«¯åˆ°ç«¯æµ‹è¯•ç­–ç•¥

#### å®Œæ•´ä»»åŠ¡æ‰§è¡Œæµç¨‹

```
1. æ·»åŠ ä»»åŠ¡ â†’ éªŒè¯é˜Ÿåˆ— â†’ å¯åŠ¨è°ƒåº¦å™¨ â†’ ç­‰å¾…æ‰§è¡Œ â†’ éªŒè¯å®Œæˆ
2. åˆ›å»ºå®šæ—¶ä»»åŠ¡ â†’ ç­‰å¾…åˆ°æœŸ â†’ éªŒè¯åŠ å…¥é˜Ÿåˆ— â†’ æ‰§è¡Œ â†’ éªŒè¯ç»“æœ
3. æ‰§è¡Œå¤±è´¥ â†’ éªŒè¯é‡è¯• â†’ æœ€ç»ˆå¤±è´¥ â†’ éªŒè¯è®°å½•
```

#### å…³é”®åœºæ™¯æµ‹è¯•

| åœºæ™¯ | æµ‹è¯•æ­¥éª¤ | é¢„æœŸç»“æœ |
|------|----------|----------|
| æ­£å¸¸æ‰§è¡Œ | æ·»åŠ ä»»åŠ¡ â†’ å¯åŠ¨è°ƒåº¦å™¨ â†’ ç­‰å¾…å®Œæˆ | çŠ¶æ€ COMPLETED |
| è¶…æ—¶å¤„ç† | æ·»åŠ é•¿ä»»åŠ¡ â†’ è®¾ç½®çŸ­è¶…æ—¶ â†’ æ‰§è¡Œ | è§¦å‘é‡è¯•æˆ–å¤±è´¥ |
| é‡è¯•æœºåˆ¶ | Mock å¤±è´¥ â†’ æ‰§è¡Œä»»åŠ¡ â†’ æ£€æŸ¥é‡è¯• | é‡è¯•æ¬¡æ•°é€’å¢ |
| å®šæ—¶è§¦å‘ | åˆ›å»ºå®šæ—¶ä»»åŠ¡ â†’ ç­‰å¾…åˆ°æœŸ â†’ æ£€æŸ¥é˜Ÿåˆ— | ä»»åŠ¡è‡ªåŠ¨åŠ å…¥é˜Ÿåˆ— |
| å¹¶å‘å®‰å…¨ | å¹¶å‘æ·»åŠ å¤šä¸ªä»»åŠ¡ â†’ æ£€æŸ¥æ•°æ®ä¸€è‡´æ€§ | æ•°æ®æ— æŸå |

#### æ‰‹åŠ¨éªŒæ”¶æ¸…å•

- [ ] Web ç•Œé¢æ·»åŠ ä»»åŠ¡ï¼Œä»»åŠ¡æ­£ç¡®æ˜¾ç¤ºåœ¨é˜Ÿåˆ—ä¸­
- [ ] å¯åŠ¨è°ƒåº¦å™¨ï¼Œä»»åŠ¡å¼€å§‹æ‰§è¡Œ
- [ ] ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼ŒçŠ¶æ€æ­£ç¡®æ›´æ–°
- [ ] å®šæ—¶ä»»åŠ¡åˆ°æœŸåè‡ªåŠ¨åŠ å…¥é˜Ÿåˆ—
- [ ] å¤±è´¥ä»»åŠ¡æ­£ç¡®æ˜¾ç¤ºåœ¨å¤±è´¥åˆ—è¡¨
- [ ] åˆ†é¡µåŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] Cron è¡¨è¾¾å¼éªŒè¯å®æ—¶åé¦ˆ

### æ€§èƒ½æµ‹è¯•æ–¹æ¡ˆ

#### æµ‹è¯•åœºæ™¯

| åœºæ™¯ | æµ‹è¯•æ–¹æ³• | é¢„æœŸç»“æœ |
|------|----------|----------|
| å¤§é‡ä»»åŠ¡å…¥é˜Ÿ | æ·»åŠ  1000 ä¸ªä»»åŠ¡ | é˜Ÿåˆ—æ“ä½œ < 1s |
| åˆ†é¡µæŸ¥è¯¢ | æŸ¥è¯¢ 10000 æ¡å†å² | å“åº” < 500ms |
| Cron è§£æ | è§£æ 100 ä¸ªè¡¨è¾¾å¼ | < 100ms |
| å¹¶å‘å­˜å‚¨ | 10 ä¸ªå¹¶å‘å†™å…¥ | æ•°æ®æ— æŸå |

#### æ€§èƒ½æµ‹è¯•ç¤ºä¾‹

```python
class TestPerformance:
    def test_cron_parse_performance(self):
        """æµ‹è¯• Cron è§£ææ€§èƒ½"""
        parser = CronParser()
        expressions = ["*/5 * * * *", "0 9 * * 1-5", "0 0 1 1 *"]

        start = time.time()
        for _ in range(100):
            for expr in expressions:
                parser.parse(expr)
        elapsed = time.time() - start

        assert elapsed < 0.1  # 100 æ¬¡è§£æ < 100ms

    def test_queue_add_performance(self):
        """æµ‹è¯•é˜Ÿåˆ—æ·»åŠ æ€§èƒ½"""
        storage = get_storage()

        start = time.time()
        for i in range(1000):
            task = Task(id=str(uuid.uuid4()), prompt=f"ä»»åŠ¡ {i}")
            storage.queue.add(task)
        elapsed = time.time() - start

        assert elapsed < 1.0  # 1000 æ¬¡æ·»åŠ  < 1s
```

### æµ‹è¯•æ‰§è¡ŒæŒ‡å—

#### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰è°ƒåº¦å™¨æµ‹è¯•
uv run pytest tests/test_scheduler*.py -v

# è¿è¡Œå¹¶æ˜¾ç¤ºè¦†ç›–ç‡
uv run pytest tests/test_scheduler*.py -v --cov=app/scheduler --cov-report=term-missing

# è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
uv run pytest tests/test_scheduler_cron.py::TestCronSpecialCharacters -v
```

#### æµ‹è¯•éš”ç¦»

```python
@pytest.fixture
def isolated_storage(tmp_path):
    """ä½¿ç”¨ä¸´æ—¶ç›®å½•çš„éš”ç¦»å­˜å‚¨"""
    storage = TaskStorage(data_dir=str(tmp_path))
    yield storage
    shutil.rmtree(tmp_path)
```

#### Mock ç­–ç•¥

```python
@pytest.fixture
def mock_executor():
    """åˆ›å»ºæ¨¡æ‹Ÿæ‰§è¡Œå™¨"""
    executor = MagicMock(spec=TaskExecutor)
    executor.execute = AsyncMock(return_value=ExecutionResult(
        success=True,
        message="æ‰§è¡ŒæˆåŠŸ",
    ))
    return executor
```

### æµ‹è¯•éªŒæ”¶æ ‡å‡†

#### åŠŸèƒ½éªŒæ”¶

- [x] æ·»åŠ ä»»åŠ¡åˆ°é˜Ÿåˆ—
- [x] è·å–ä»»åŠ¡é˜Ÿåˆ—åˆ—è¡¨
- [x] åˆ é™¤é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡
- [x] æ¸…ç©ºä»»åŠ¡é˜Ÿåˆ—
- [x] åˆ›å»ºå®šæ—¶ä»»åŠ¡
- [x] Cron è¡¨è¾¾å¼æ­£ç¡®è§£æ
- [x] æ›´æ–°å®šæ—¶ä»»åŠ¡
- [x] å¯ç”¨/ç¦ç”¨å®šæ—¶ä»»åŠ¡
- [x] ç«‹å³æ‰§è¡Œå®šæ—¶ä»»åŠ¡
- [x] åˆ é™¤å®šæ—¶ä»»åŠ¡
- [x] è·å–è¿è¡Œä¸­ä»»åŠ¡
- [x] è·å–å·²å®Œæˆä»»åŠ¡ï¼ˆåˆ†é¡µï¼‰
- [x] è·å–å¤±è´¥ä»»åŠ¡ï¼ˆåˆ†é¡µï¼‰
- [x] ä»»åŠ¡æ‰§è¡Œè¶…æ—¶æ§åˆ¶
- [x] ä»»åŠ¡å¤±è´¥é‡è¯•ï¼ˆæœ€å¤š 2 æ¬¡ï¼‰
- [x] è·å–è°ƒåº¦å™¨çŠ¶æ€
- [x] å¯åŠ¨/åœæ­¢è°ƒåº¦å™¨
- [x] å®šæ—¶ä»»åŠ¡åˆ°æœŸè‡ªåŠ¨åŠ å…¥é˜Ÿåˆ—

#### è¦†ç›–ç‡éªŒæ”¶

| æ¨¡å— | ç›®æ ‡ | å½“å‰ |
|------|------|------|
| models.py | â‰¥ 95% | âœ… |
| cron.py | â‰¥ 95% | âœ… |
| storage.py | â‰¥ 90% | âœ… |
| executor.py | â‰¥ 90% | âœ… |
| scheduler.py | â‰¥ 85% | âœ… |
| routers/scheduler.py | â‰¥ 80% | âœ… |

#### è´¨é‡éªŒæ”¶

- [ ] æ—  P0/P1 çº§åˆ« Bug
- [ ] æµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•è¾¾æ ‡
- [ ] æ— å®‰å…¨æ¼æ´

### æŒç»­æ”¹è¿›

#### æµ‹è¯•ç»´æŠ¤

- æ–°åŠŸèƒ½å¿…é¡»åŒ…å«æµ‹è¯•
- Bug ä¿®å¤å¿…é¡»æ·»åŠ å›å½’æµ‹è¯•
- å®šæœŸæ›´æ–°æµ‹è¯•ç”¨ä¾‹

#### æµ‹è¯•æŠ¥å‘Š

```bash
# ç”Ÿæˆ HTML è¦†ç›–ç‡æŠ¥å‘Š
uv run pytest tests/ --cov=app/scheduler --cov-report=html

# æŸ¥çœ‹æŠ¥å‘Š
open htmlcov/index.html
```

---

## v0.6.7 ä¼˜åŒ–æ–¹æ¡ˆè®¾è®¡

> ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿçš„æ€§èƒ½ä¼˜åŒ–ã€ç”¨æˆ·ä½“éªŒä¼˜åŒ–å’Œå®‰å…¨åŠ å›ºæ–¹æ¡ˆã€‚
> **æœ€åæ›´æ–°**: 2026-02-27

### å·²å®ç°çš„ä¼˜åŒ–

æ ¹æ® v0.6å¼€å‘è®¡åˆ’.mdï¼Œä»¥ä¸‹ä¼˜åŒ–å·²åœ¨ v0.6.7 ç‰ˆæœ¬ä¸­å®ç°ï¼š

| ç±»åˆ« | ä¼˜åŒ–é¡¹ | å®ç°ä½ç½® |
|------|--------|----------|
| æ€§èƒ½ä¼˜åŒ– | è½®è¯¢é—´éš”ä¼˜åŒ– | `web/static/modules/scheduler.js` - 5ç§’åˆ·æ–° + 1ç§’è¿è¡Œæ—¶é•¿æ›´æ–° |
| æ€§èƒ½ä¼˜åŒ– | çŠ¶æ€æ›´æ–°èŠ‚æµ | `web/static/modules/scheduler.js` - Cron éªŒè¯ä½¿ç”¨ 300ms debounce |
| æ€§èƒ½ä¼˜åŒ– | å¤§æ•°æ®é‡åˆ†é¡µ | `app/scheduler/storage.py` - å·²å®Œæˆ/å¤±è´¥ä»»åŠ¡åˆ†é¡µåŠŸèƒ½ |
| æ€§èƒ½ä¼˜åŒ– | Cron è§£ææ€§èƒ½ | `app/scheduler/cron.py` - CronParser ä½¿ç”¨ç¼“å­˜ |
| ç”¨æˆ·ä½“éªŒ | åŠ è½½çŠ¶æ€æç¤º | `web/static/modules/scheduler.js` - state.loading çŠ¶æ€ç®¡ç† |
| ç”¨æˆ·ä½“éªŒ | æ“ä½œåé¦ˆ | `web/static/utils.js` - Utils.showNotification |
| ç”¨æˆ·ä½“éªŒ | è¡¨å•éªŒè¯æç¤º | `web/static/modules/scheduler.js` - å®æ—¶ Cron éªŒè¯åé¦ˆ |
| ç”¨æˆ·ä½“éªŒ | ç©ºçŠ¶æ€æç¤º | `web/static/modules/scheduler.js` - æš‚æ—  xxx ä»»åŠ¡ |
| ç”¨æˆ·ä½“éªŒ | å“åº”å¼å¸ƒå±€ | `web/static/css/components.css` - æ–­ç‚¹è®¾è®¡ |
| å®‰å…¨ | API æƒé™æ§åˆ¶ | `app/routers/scheduler.py` - OAuth2 å¯é€‰è®¤è¯ |
| å®‰å…¨ | è¾“å…¥éªŒè¯ | `app/routers/scheduler.py` - validate_prompt/name/timeout/tools/task_id |
| å®‰å…¨ | æ–‡ä»¶è·¯å¾„å®‰å…¨ | `app/routers/scheduler.py` - validate_workspace é˜²æ­¢è·¯å¾„éå† |
| å®‰å…¨ | é”™è¯¯ä¿¡æ¯æ³„éœ² | `app/routers/scheduler.py` - ä½¿ç”¨é€šç”¨é”™è¯¯æ¶ˆæ¯ |
| å®‰å…¨ | XSS é˜²æŠ¤ | `web/static/modules/scheduler.js` - escapeHtml å‡½æ•° |
| å®‰å…¨ | CSRF é˜²æŠ¤ | FastAPI å†…ç½®é˜²æŠ¤ |

### åç»­æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### å­˜å‚¨å±‚ä¼˜åŒ–

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| å†…å­˜ç¼“å­˜ | å¯¹é¢‘ç¹è®¿é—®çš„æ•°æ®ï¼ˆå¦‚é˜Ÿåˆ—ã€è¿è¡Œä¸­ä»»åŠ¡ï¼‰ä½¿ç”¨å†…å­˜ç¼“å­˜ | é«˜ |
| æ‰¹é‡å†™å…¥ | å°†å¤šæ¬¡å†™æ“ä½œåˆå¹¶ä¸ºæ‰¹é‡å†™å…¥ | ä¸­ |
| å¼‚æ­¥æŒä¹…åŒ– | ä½¿ç”¨åå°çº¿ç¨‹å®šæœŸæŒä¹…åŒ–å†…å­˜æ•°æ® | ä¸­ |
| æ•°æ®åº“è¿ç§» | å¤§è§„æ¨¡åœºæ™¯ä¸‹è¿ç§»åˆ° SQLite æˆ– Redis | ä½ |

```python
# å»ºè®®æ–°å¢: app/scheduler/cache.py
class SchedulerCache:
    """è°ƒåº¦å™¨å†…å­˜ç¼“å­˜"""
    def __init__(self, ttl_seconds: int = 30):
        self._cache: dict[str, CacheEntry] = {}
        self._ttl = ttl_seconds

    def get(self, key: str) -> Optional[Any]:
        entry = self._cache.get(key)
        if entry and datetime.now() < entry.expires_at:
            return entry.data
        return None
```

#### å‰ç«¯ä¼˜åŒ–

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| è™šæ‹Ÿæ»šåŠ¨ | é•¿åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨æŠ€æœ¯ | ä¸­ |
| æ‡’åŠ è½½ | è¯¦æƒ…å¯¹è¯æ¡†å†…å®¹å»¶è¿ŸåŠ è½½ | ä½ |
| æœ¬åœ°ç¼“å­˜ | ä½¿ç”¨ localStorage ç¼“å­˜ Cron ç¤ºä¾‹ç­‰é™æ€æ•°æ® | ä½ |

#### è°ƒåº¦å™¨ä¼˜åŒ–

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| å¹¶å‘æ‰§è¡Œ | æ”¯æŒé…ç½®æœ€å¤§å¹¶å‘ä»»åŠ¡æ•° | ä¸­ |
| ä»»åŠ¡ä¼˜å…ˆçº§ | å®ç°ä»»åŠ¡ä¼˜å…ˆçº§é˜Ÿåˆ— | ä½ |
| ä»»åŠ¡åˆ†ç»„ | æŒ‰å·¥ä½œç›®å½•åˆ†ç»„æ‰§è¡Œï¼Œå‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ | ä½ |

### åç»­ç”¨æˆ·ä½“éªŒä¼˜åŒ–å»ºè®®

#### äº¤äº’ä½“éªŒ

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| æ‰¹é‡æ“ä½œ | æ”¯æŒæ‰¹é‡åˆ é™¤ä»»åŠ¡ | ä¸­ |
| å¿«æ·é”®æ”¯æŒ | æ·»åŠ å¸¸ç”¨æ“ä½œå¿«æ·é”® | ä½ |
| æ‹–æ‹½æ’åº | æ”¯æŒä»»åŠ¡é˜Ÿåˆ—æ‹–æ‹½æ’åº | ä½ |
| æœç´¢è¿‡æ»¤ | æ”¯æŒæŒ‰åç§°/çŠ¶æ€æœç´¢ä»»åŠ¡ | ä¸­ |

#### ä¿¡æ¯å±•ç¤º

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| ä»»åŠ¡è¿›åº¦æ¡ | é•¿ä»»åŠ¡æ˜¾ç¤ºé¢„ä¼°è¿›åº¦ | ä½ |
| è´¹ç”¨ç»Ÿè®¡ | æ˜¾ç¤ºä»»åŠ¡æ‰§è¡Œè´¹ç”¨æ±‡æ€» | ä¸­ |
| å®æ—¶æ—¥å¿— | ä»»åŠ¡æ‰§è¡Œæ—¶æ˜¾ç¤ºå®æ—¶æ—¥å¿—ï¼ˆSSEï¼‰ | ä¸­ |

#### é”™è¯¯å¤„ç†

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| ç½‘ç»œæ–­å¼€é‡è¿ | ç½‘ç»œæ¢å¤åè‡ªåŠ¨é‡æ–°åŠ è½½æ•°æ® | é«˜ |
| å‹å¥½é”™è¯¯é¡µ | API é”™è¯¯æ—¶æ˜¾ç¤ºå‹å¥½æç¤º | ä¸­ |

### åç»­å®‰å…¨åŠ å›ºå»ºè®®

#### è®¤è¯ä¸æˆæƒ

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| å¼ºåˆ¶è®¤è¯é€‰é¡¹ | æä¾›é…ç½®é¡¹å¼ºåˆ¶è¦æ±‚è®¤è¯ | é«˜ |
| API Key è®¤è¯ | æ”¯æŒ API Key æ–¹å¼è®¤è¯ | ä¸­ |
| è§’è‰²æƒé™æ§åˆ¶ | ä¸åŒè§’è‰²æœ‰ä¸åŒçš„æ“ä½œæƒé™ | ä½ |
| æ“ä½œå®¡è®¡æ—¥å¿— | è®°å½•å…³é”®æ“ä½œçš„å®¡è®¡æ—¥å¿— | ä¸­ |

#### è¾“å…¥éªŒè¯å¢å¼º

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| Cron è¡¨è¾¾å¼å¤æ‚åº¦é™åˆ¶ | é™åˆ¶ Cron è¡¨è¾¾å¼å¤æ‚åº¦é˜²æ­¢ ReDoS | é«˜ |
| å·¥ä½œç›®å½•ç™½åå• | é…ç½®å…è®¸çš„å·¥ä½œç›®å½•åˆ—è¡¨ | é«˜ |
| å·¥å…·åˆ—è¡¨éªŒè¯ | éªŒè¯å·¥å…·åç§°åœ¨å…è®¸èŒƒå›´å†… | ä¸­ |

```python
# å·¥ä½œç›®å½•ç™½åå•éªŒè¯
ALLOWED_WORKSPACES = os.getenv("ALLOWED_WORKSPACES", "").split(",")

def validate_workspace_enhanced(workspace: str) -> str:
    workspace = validate_workspace(workspace)
    if ALLOWED_WORKSPACES:
        workspace_path = Path(workspace).resolve()
        for allowed_dir in ALLOWED_WORKSPACES:
            if workspace_path.is_relative_to(Path(allowed_dir).resolve()):
                return workspace
        raise HTTPException(status_code=400, detail="å·¥ä½œç›®å½•ä¸åœ¨å…è®¸èŒƒå›´å†…")
    return workspace
```

#### é€Ÿç‡é™åˆ¶

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| API é€Ÿç‡é™åˆ¶ | ä½¿ç”¨ slowapi æ·»åŠ å…¨å±€ API é€Ÿç‡é™åˆ¶ | é«˜ |
| ä»»åŠ¡åˆ›å»ºé™åˆ¶ | é™åˆ¶ä»»åŠ¡åˆ›å»ºé¢‘ç‡ | é«˜ |
| IP é»‘åå• | æ”¯æŒé…ç½® IP é»‘åå• | ä½ |

```python
# ä½¿ç”¨ slowapi æ·»åŠ é€Ÿç‡é™åˆ¶
from slowapi import Limiter
from slowapi.util import get_remote_address

limiter = Limiter(key_func=get_remote_address)

@limiter.limit("30/minute")
@app.post("/api/tasks")
async def create_task(request: Request, ...):
    ...
```

#### ä»»åŠ¡è°ƒåº¦ç‰¹æœ‰å®‰å…¨

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| ä»»åŠ¡æ‰§è¡Œéš”ç¦» | ä¸åŒå·¥ä½œç›®å½•çš„ä»»åŠ¡éš”ç¦»æ‰§è¡Œ | é«˜ |
| èµ„æºé™åˆ¶ | é™åˆ¶ä»»åŠ¡æ‰§è¡Œçš„ CPU/å†…å­˜/æ—¶é—´ | é«˜ |
| å±é™©å·¥å…·é™åˆ¶ | ç¦æ­¢æˆ–é™åˆ¶ä½¿ç”¨å±é™©å·¥å…·ï¼ˆBashã€Writeã€Editï¼‰ | ä¸­ |

### å®æ–½ä¼˜å…ˆçº§

#### é«˜ä¼˜å…ˆçº§ï¼ˆv0.7.xï¼‰

| ä¼˜åŒ–é¡¹ | ç±»å‹ | é¢„è®¡å·¥ä½œé‡ |
|--------|------|------------|
| API é€Ÿç‡é™åˆ¶ | å®‰å…¨ | 2h |
| å¼ºåˆ¶è®¤è¯é€‰é¡¹ | å®‰å…¨ | 1h |
| å·¥ä½œç›®å½•ç™½åå• | å®‰å…¨ | 1h |
| ç½‘ç»œæ–­å¼€é‡è¿ | æ€§èƒ½ | 2h |
| å†…å­˜ç¼“å­˜ | æ€§èƒ½ | 4h |

#### ä¸­ä¼˜å…ˆçº§ï¼ˆv0.8.xï¼‰

| ä¼˜åŒ–é¡¹ | ç±»å‹ | é¢„è®¡å·¥ä½œé‡ |
|--------|------|------------|
| å¹¶å‘æ‰§è¡Œæ”¯æŒ | æ€§èƒ½ | 8h |
| æ‰¹é‡æ“ä½œ | ç”¨æˆ·ä½“éªŒ | 4h |
| API Key è®¤è¯ | å®‰å…¨ | 4h |
| æœç´¢è¿‡æ»¤ | ç”¨æˆ·ä½“éªŒ | 4h |
| æ“ä½œå®¡è®¡æ—¥å¿— | å®‰å…¨ | 4h |

#### ä½ä¼˜å…ˆçº§ï¼ˆåç»­ç‰ˆæœ¬ï¼‰

| ä¼˜åŒ–é¡¹ | ç±»å‹ | é¢„è®¡å·¥ä½œé‡ |
|--------|------|------------|
| è™šæ‹Ÿæ»šåŠ¨ | æ€§èƒ½ | 4h |
| æ•°æ®åº“è¿ç§» | æ€§èƒ½ | 16h |
| è§’è‰²æƒé™æ§åˆ¶ | å®‰å…¨ | 8h |
| å®æ—¶æ—¥å¿— | ç”¨æˆ·ä½“éªŒ | 8h |

### ç›‘æ§ä¸æŒ‡æ ‡å»ºè®®

#### æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | è¯´æ˜ | é‡‡é›†æ–¹å¼ |
|------|------|----------|
| API å“åº”æ—¶é—´ | å„ API ç«¯ç‚¹çš„å“åº”æ—¶é—´ | ä¸­é—´ä»¶ |
| ä»»åŠ¡æ‰§è¡Œæ—¶é—´ | ä»»åŠ¡ä»å¼€å§‹åˆ°å®Œæˆçš„è€—æ—¶ | æ‰§è¡Œå™¨ |
| é˜Ÿåˆ—ç­‰å¾…æ—¶é—´ | ä»»åŠ¡åœ¨é˜Ÿåˆ—ä¸­çš„ç­‰å¾…æ—¶é—´ | è°ƒåº¦å™¨ |
| å­˜å‚¨æ“ä½œè€—æ—¶ | JSON æ–‡ä»¶è¯»å†™è€—æ—¶ | å­˜å‚¨å±‚ |
| Cron è§£æè€—æ—¶ | Cron è¡¨è¾¾å¼è§£æè€—æ—¶ | è§£æå™¨ |

#### ä¸šåŠ¡æŒ‡æ ‡

| æŒ‡æ ‡ | è¯´æ˜ | é‡‡é›†æ–¹å¼ |
|------|------|----------|
| ä»»åŠ¡æˆåŠŸç‡ | æˆåŠŸä»»åŠ¡/æ€»ä»»åŠ¡æ•° | å†å²è®°å½• |
| å¹³å‡é‡è¯•æ¬¡æ•° | ä»»åŠ¡å¹³å‡é‡è¯•æ¬¡æ•° | æ‰§è¡Œå™¨ |
| å®šæ—¶ä»»åŠ¡å‡†æ—¶ç‡ | å®šæ—¶ä»»åŠ¡å‡†æ—¶æ‰§è¡Œæ¯”ä¾‹ | è°ƒåº¦å™¨ |
| API é”™è¯¯ç‡ | API é”™è¯¯å“åº”æ¯”ä¾‹ | ä¸­é—´ä»¶ |

---

**æ–‡æ¡£ç‰ˆæœ¬**: v0.6.7
**æœ€åæ›´æ–°**: 2026-02-27
